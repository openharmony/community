# OpenHarmony社区版本发布开源合规专项评审规范

## 目的

本文档定义的规范确保OpenHarmony社区版本发布时，社区各角色对于社区版本发布评审中开源合规专项的评审要求理解清晰、一致，一方面帮助负责社区版本发布人员可按照本文档完成相关开源合规项举证准备，另一方面，帮助合规SIG专业评审人员在评审标准等维度达成一致理解。

## 范围

本指导适用于OpenHarmony社区在研主线最新版本申请发布评审（含正式版本、LTS版本、beta版本），同时也包含已发布版本再维护状态下申请补丁版本发布评审

## 本文的改进和修订说明

1. 本文档由合规SIG主导起草和维护。最新版本可以在 [这里](OpenHarmony社区版本发布开源合规专项评审规范.md)找到。
2. 任何对于本文中涉及的规则的增加，修改，删除都必须可追溯 。
3. 最终规则经过社区充分的讨论后，由PMC评审定稿。

## 术语和缩略语

|  术语  | 说明  |
| :------------ | :------------ |
| 静态检查| 对源代码或二进制基于静态程序分析等技术进行规则检查，用于保障代码的规范、安全、合规 |
| 开源义务履行| 依据所使用开源软件中的开源许可证中所规定的条款要求，对条款规则中要求的义务项进行履行 |
| NOTICE| 即开源软件使用声明，是常见的许可证中规定的义务项所对应的交付件 |


## 开源合规举证及评审规范
###  整体原则
整体遵从[版本质量要求](https://gitcode.com/openharmony/community/blob/master/sig/sig_qa/%E7%89%88%E6%9C%AC%E8%B4%A8%E9%87%8F%E8%A6%81%E6%B1%82.md)中对于开源合规的要求，其中主要涉及为以下两项：

|  质量要求小类 |Canary版本   |Beta版本   |正式版/LTS版本| 说明 |
| :------------ | :------------ | :------------ | :------------ | :------------ |
| 静态检查| NA  |清零   |清零   | 包括代码规范检查、合规检查、安全检查报告 |
| 开源义务履行| NA  |通过  |通过   | 二进制分发时镜像包中system/etc下是否包含NOTICE.txt |

### 开源合规举证材料要求
#### OpenHarmony社区静态检查开源合规告警清零
举证OpenHarmony社区数字化协作平台静态检查专项中[仓库缺陷统计](http://ci.openharmony.cn/workbench/cicd/codeQuality/staticcheck/warehousedefect)内容,选择申请发布的版本分支，举证该分支下全部代码仓中问题总数清零，证明本次待发布的版本，对于版权、许可证、二进制等开源合规相关风险均**已通过社区工具**检查并完成风险清零。

**举证材料：**
1. 该分支下全部代码仓的开源合规检查项OAT、wordstool、Fossscan三项告警检查项全部清零截图。
2. 该分支下全部代码仓的开源合规检查项OAT、wordstool、Fossscan三项告警清零的导出报告。
#### 商业开源合规工具FossLicense开源合规告警清零
举证社区采购的开源合规工具（当前为FossLicense）中的内容，选择申请发布的版本分支，举证该分支下全部代码仓的全量告警已清零，证明本次待发布的版本，对于版权、许可证、二进制等开源合规相关风险均**已通过商业独立合规工具**检查并完成风险清零。

**举证材料**
1. 该分支下全部代码仓的许可证兼容性告警、版权篡改告警、许可证篡改告警全部清零截图。
2. 该分支下全部代码仓的许可证兼容性告警、版权篡改告警、许可证篡改告警告警清零的导出报告，其中须包含全量风险报告、澄清报告，特别需注意的是，澄清报告需要标识本次扫描中涉及的澄清条目，由于当前工具仅能对澄清记录进行分支统计，因此，需要标识出本次增量澄清项内容。

#### 开源义务履行-NOTICE文本
举证随版本发布的系统镜像及SDK等二进制中，包含了开源软件使用声明，证明完善无误的履行了其引入和分发的第三方开源软件中许可证要求的开源义务。

**举证材料**
1. 待发布的系统镜像及SDK等二进制中存在NOTICE文件的截图。
2. 待发布的系统镜像及SDK等二进制中的NOTICE文件导出归档。

### 具体评审要点规范
#### OpenHarmony社区静态检查开源合规评审规范 
1. 静态检查代码仓：被检查的代码仓是否同发布范围一致，发布范围内包含的全量代码仓都需经过静态检查
2. 静态检查执行时间：审核OpenHarmony社区数字化协作平台静态检查专项中[仓库缺陷统计](http://ci.openharmony.cn/workbench/cicd/codeQuality/staticcheck/warehousedefect)内容中所有仓库的执行时间，是否为最新时间，是否与发布内容保持一致，是否被有效执行。
3. 静态告警清零：审核告警页面中告警是否全部清零。
4. 告警屏蔽是否合理：基于CI系统抽查已屏蔽告警是否合理。

#### 商业开源合规工具FossLicense评审规范
1. 代码仓：被检查的代码仓是否同发布范围一致，发布范围内包含的全量代码仓都需经过FossLicense检查
2. 执行时间：审核FossLicense代码仓的执行时间，确认所有仓库的执行时间，是否为最新时间，是否与发布内容保持一致，是否被有效执行。
3. 告警清零：审核告警页面中告警是否全部清零。
4. 告警澄清是否合理：基于导出的澄清记录抽查已澄清内容是否合理，是否满足[《FossLicense开源合规告警澄清规范》](FossLicense开源合规告警澄清规范.md)。

#### 开源义务履行-NOTICE文本
1. 存放位置：审核NOTICE文件按照规定存放在对应位置。
2. 格式： 审核NOTICE格式是否符合社区NOTICE规范 。
3. 内容：审核及抽查NOTICE文本中是否有实际使用但未进行声明的软件。

### 版本发布合规评审流程
#### 主线版本发布评审流程
1. 版本发布前，需提前两周申报合规SIG例会议题，按照开源合规举证材料要求，在合规SIG进行合规评审。
2. 版本发布评审会由合规SIG leader 作为合规代表，将合规SIG评审结论作为评审意见进行反馈。
3. 版本正式发布前，原则上应闭环完全部合规评审遗留问题。

#### 补丁版本发布流程
1. 版本发布前，需提前4天通过邮件发送开源合规举证材料，由合规SIG补丁版本审核代表团（3名 committer）邮件审核，需要获得2名committer以上同意。
2. 版本发布评审会由合规SIG leader 作为合规代表，将合规SIG评审结论作为评审意见进行反馈。
3. 版本正式发布前，原则上应闭环完全部合规评审遗留问题。

